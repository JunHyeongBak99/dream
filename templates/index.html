<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Interpretation Blog & Encyclopedia Search</title>
    <style>
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(to bottom, #0b1e2e, #f8c9d4); /* 그라데이션 배경 */
        }
        body {
            margin: 0;
            overflow: hidden;
            height: 100vh;
        }
        .content {
            position: relative;
            z-index: 1;
            color: white;
            text-align: center;
            padding-top: 50px;
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div class="content">
        <h1>Dream Interpretation Blog & Encyclopedia Search</h1>
        <input type="text" id="query" placeholder="Enter a keyword for dream interpretation">
        <button onclick="search()">Search</button>
        <div id="results"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.0.0/tsparticles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/preset-stars@3/tsparticles.preset.stars.bundle.min.js"></script>
    <script>
        async function loadParticles() {
            await loadStarsPreset(tsParticles);
            tsParticles.load("particles-js", {
                particles: {
                    number: {
                        value: 150,
                        density: {
                            enable: true,
                            value_area: 800
                        }
                    },
                    color: { value: "#ffffff" },
                    shape: { type: "star", stroke: { width: 0, color: "#000000" } },
                    opacity: { value: 0.7, random: false },
                    size: { value: 4, random: true },
                    move: { enable: true, speed: 3, direction: "none", random: false }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: {
                        onhover: { enable: true, mode: "repulse" },
                        onclick: { enable: true, mode: "push" },
                        resize: true
                    },
                    modes: {
                        repulse: { distance: 100, duration: 0.4 },
                        push: { particles_nb: 4 }
                    }
                },
                retina_detect: true
            });
        }

        loadParticles();

        function search() {
            const query = document.getElementById('query').value;
            if (query) {
                fetch(`/search?query=${encodeURIComponent(query)}`)
                    .then(response => response.json())
                    .then(data => {
                        const resultsDiv = document.getElementById('results');
                        resultsDiv.innerHTML = '';
                        if (data.error) {
                            resultsDiv.innerHTML = `<p>${data.error}</p>`;
                        } else {
                            if (data.dream_results) {
                                resultsDiv.innerHTML += '<h2>Encyclopedia Results:</h2>';
                                data.dream_results.forEach(item => {
                                    const p = document.createElement('p');
                                    p.innerHTML = `<strong>${item.title}</strong><br>${item.description}<br><a href="${item.link}" target="_blank">Read more</a>`;
                                    resultsDiv.appendChild(p);
                                });
                            }
                            if (data.blog_results) {
                                resultsDiv.innerHTML += '<h2>Blog Results:</h2>';
                                data.blog_results.forEach(item => {
                                    const p = document.createElement('p');
                                    p.innerHTML = `<strong>${item.title}</strong><br>${item.description}<br><a href="${item.link}" target="_blank">Read more</a>`;
                                    resultsDiv.appendChild(p);
                                });
                            }
                            if (data.openai_response) {
                                resultsDiv.innerHTML += '<h2>AI Chatbot Response:</h2>';
                                const p = document.createElement('p');
                                p.innerHTML = data.openai_response;
                                resultsDiv.appendChild(p);
                            }
                        }
                    });
            } else {
                alert('Please enter a keyword for dream interpretation');
            }
        }
    </script>
</body>
</html>